!function(){"use strict";class e{constructor(e,t){let{data:r,userID:s,isLiked:i,handleImageClick:o,handleDeleteCardClick:n,handleCardLikeClick:a,handleConfirm:l}=e;this._handleConfirm=l,this._name=r.name,this._link=r.link,this._owner=r.owner,this._id=r._id,this._userID=s,this._isLiked=r.isLiked,this._cardSelector=t,this._handleImageClick=o,this._handleDeleteCardClick=n,this._handleCardLikeClick=a}getId(){return this._id}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._cardElement=this._getTemplate(),this._cardElement.querySelector(".card__image").src=this._link,this._cardElement.querySelector(".card__image").alt=`Photo of ${this._name}`,this._cardCaption=this._cardElement.querySelector(".card__title"),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardCaption.textContent=this._name,this._setEventListeners(),this._renderLikes(),this._cardElement}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleCardLikeClick(this._id,this._isLiked)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteCardClick())),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>this._handleImageClick({link:this._link,text:this._name})))}_renderLikes(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}setLike(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_hasInvalidInput(){return!this._inputEls.every((e=>e.validity.valid))}toggleButtonState(){if(this._hasInvalidInput(this._inputEls))return this._submitButton.classList.add(this._inactiveButtonClass),void(this._submitButton.disabled=!0);this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_checkInputValidity(e){return e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputEls=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const r={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose)}_handleEscClose(e){27===e.which&&this.close()}setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}}class i extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._popupElement=document.querySelector(e),this.submitButton=this._popupForm.querySelector(".modal__button"),this.submitButtonText=this.submitButton.textContent}_getInputValues(){return this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._formValues={},this._inputList.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this.submitButton.textContent=e?t:this.submitButtonText}setEventListeners(){this._popupElement.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues()),this.close()})),super.setEventListeners()}close(){this._popupForm.reset(),super.close()}}const o=document.querySelector("#profile-edit-button"),n=document.querySelector(".profile__avatar-container"),a=document.querySelector("#profile-edit-modal"),l=document.querySelector("#avatar-edit-modal"),c=document.querySelector("#add-card-modal"),d=(document.querySelector("#image-popup"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input")),h=document.querySelector("#profile-decription-input"),u=a.querySelector(".modal__form"),_=(document.querySelector(".profile__image"),document.querySelector("#card-template").content.firstElementChild,document.querySelector(".profile__add-button")),m=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._authorization=r.authorization}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}updateProfileInfo(e){let{title:t,description:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}updateAvatar(e){let{avatar:t}=e;return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:this._authorization,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}addCardLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}removeCardLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:{authorization:this._authorization,"Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:this._authorization}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._authorization}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"27d1bd70-108d-4f8b-b35a-2fb4fb8998a7","Content-Type":"application/json"}}),p=new i("#avatar-edit-modal",(e=>{p.renderLoading(!0,"Saving..."),m.updateAvatar(e).then((e=>{C.setAvatar(e.avatar),p.close()})).catch((e=>{console.error(e)})).finally((()=>{p.renderLoading(!1)}))})),E={popupSelector:"#image-popup"},v=new class extends s{constructor(e){super(e),this._modalImageEl=this._popupElement.querySelector(".modal__image"),this._modalCaption=this._popupElement.querySelector(".modal__caption")}open(e){this._modalImageEl.src=e.link,this._modalImageEl.alt=e.name,this._modalCaption.textContent=e.text,super.open()}}(E),C=new class{constructor(e,t,r){this._name=document.querySelector(e),this._job=document.querySelector(t),this._avatar=document.querySelector(r)}getUserInfo(){return this._userInfo={name:this._name.textContent,description:this._job.textContent},this._userInfo}setUserInfo(e,t){this._name.textContent=e,this._job.textContent=t}setAvatar(e){this._avatar.src=e}}(".profile__title",".profile__description",".profile__image");m.getUserInfo().then((e=>{console.log(e),C.setUserInfo(e.name,e.about)}));const f=new class extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(),this.close()})),super.setEventListeners()}close(){super.close()}setSubmitAction(e){this._handleFormSubmit=e}}("#confirm-delete-modal",(e=>{f.renderLoading(!0,"Deleting..."),m.removeCard(e).then((()=>{f.close()})).catch((e=>{console.error(e)})).finally((()=>{f.renderLoading(!1)}))}));f.setEventListeners();const L=t=>new e({data:t,handleImageClick:e=>{v.open(e)},handleDeleteCardClick:q,handleCardLikeClick:B},"#card-template").getView(),k=new class{constructor(e,t){let{renderer:r}=e;this._renderer=r,this._container=document.querySelector(t)}renderItems(e){e.forEach(this._renderer)}addItem(e){this._container.prepend(e)}}({renderer:e=>{const t=L(e);k.addItem(t)}},".cards__list"),S=new i("#profile-edit-modal",(e=>{!function(e){S.renderLoading(!0,"Saving..."),m.updateProfileInfo(e).then((e=>{const{name:t,about:r}=e;C.setUserInfo(t,r),S.close()})).finally((()=>{S.renderLoading(!1)}))}(e)})),b=new i("#add-card-modal",(e=>{!function(e){b.renderLoading(!0,"Saving..."),m.addCard(e).then((e=>{const t=L(e);k.addItem(t)})).finally((()=>{b.renderLoading(!1)}))}(e)})),y=new t(r,u),g=new t(r,c),I=new t(r,l);function q(){f.open(),f.setSubmitAction((()=>{const e=this.getId();m.removeCard(e).then((e=>{this.handleDeleteCard()})).catch((e=>{console.error(e)}))}))}function B(e,t){t?m.removeCardLike(e).then((e=>this.setLike(e.isLiked))):m.addCardLike(e).then((e=>{this.setLike(e.isLiked)}))}m.getInitialCards().then((e=>{k.renderItems(e)})),v.setEventListeners(),S.setEventListeners(),b.setEventListeners(),p.setEventListeners(),y.enableValidation(),g.enableValidation(),I.enableValidation(),o.addEventListener("click",(function(){!function(){const{name:e,description:t}=C.getUserInfo();d.value=e,h.value=t}(),S.open()})),_.addEventListener("click",(()=>{g.toggleButtonState(),b.open()})),n.addEventListener("click",(()=>{I.toggleButtonState(),p.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBRWUsTUFBTUEsRUFDbkJDLFdBQUFBLENBQVdDLEVBVVRDLEdBQ0EsSUFWQSxLQUNFQyxFQUFJLE9BQ0pDLEVBQU0sUUFDTkMsRUFBTyxpQkFDUEMsRUFBZ0Isc0JBQ2hCQyxFQUFxQixvQkFDckJDLEVBQW1CLGNBQ25CQyxHQUNEUixFQUdEUyxLQUFLQyxlQUFpQkYsRUFDdEJDLEtBQUtFLE1BQVFULEVBQUtVLEtBQ2xCSCxLQUFLSSxNQUFRWCxFQUFLWSxLQUNsQkwsS0FBS00sT0FBU2IsRUFBS2MsTUFDbkJQLEtBQUtRLElBQU1mLEVBQUtlLElBQ2hCUixLQUFLUyxRQUFVZixFQUNmTSxLQUFLVSxTQUFXakIsRUFBS0UsUUFDckJLLEtBQUtXLGNBQWdCbkIsRUFDckJRLEtBQUtZLGtCQUFvQmhCLEVBQ3pCSSxLQUFLYSx1QkFBeUJoQixFQUM5QkcsS0FBS2MscUJBQXVCaEIsQ0FDOUIsQ0FFQWlCLEtBQUFBLEdBQ0UsT0FBT2YsS0FBS1EsR0FDZCxDQUVBUSxZQUFBQSxHQU1FLE9BTG9CQyxTQUNqQkMsY0FBY2xCLEtBQUtXLGVBQ25CUSxRQUFRRCxjQUFjLFNBQ3RCRSxXQUFVLEVBR2YsQ0FFQUMsT0FBQUEsR0FZRSxPQVhBckIsS0FBS3NCLGFBQWV0QixLQUFLZ0IsZUFDekJoQixLQUFLc0IsYUFBYUosY0FBYyxnQkFBZ0JLLElBQU12QixLQUFLSSxNQUMzREosS0FBS3NCLGFBQWFKLGNBQ2hCLGdCQUNBTSxJQUFPLFlBQVd4QixLQUFLRSxRQUV6QkYsS0FBS3lCLGFBQWV6QixLQUFLc0IsYUFBYUosY0FBYyxnQkFDcERsQixLQUFLMEIsWUFBYzFCLEtBQUtzQixhQUFhSixjQUFjLHNCQUNuRGxCLEtBQUt5QixhQUFhRSxZQUFjM0IsS0FBS0UsTUFDckNGLEtBQUs0QixxQkFDTDVCLEtBQUs2QixlQUNFN0IsS0FBS3NCLFlBQ2QsQ0FFQU0sa0JBQUFBLEdBRUU1QixLQUFLMEIsWUFBWUksaUJBQWlCLFNBQVMsS0FDekM5QixLQUFLYyxxQkFBcUJkLEtBQUtRLElBQUtSLEtBQUtVLFNBQVMsSUFJcERWLEtBQUtzQixhQUNGSixjQUFjLHdCQUNkWSxpQkFBaUIsU0FBUyxJQUFNOUIsS0FBS2EsMkJBR3hDYixLQUFLc0IsYUFDRkosY0FBYyxnQkFDZFksaUJBQWlCLFNBQVMsSUFDekI5QixLQUFLWSxrQkFBa0IsQ0FBRVAsS0FBTUwsS0FBS0ksTUFBTzJCLEtBQU0vQixLQUFLRSxTQUU1RCxDQUVBMkIsWUFBQUEsR0FDTTdCLEtBQUtVLFNBQ1BWLEtBQUswQixZQUFZTSxVQUFVQyxJQUFJLDRCQUUvQmpDLEtBQUswQixZQUFZTSxVQUFVRSxPQUFPLDJCQUV0QyxDQUVBQyxPQUFBQSxDQUFReEMsR0FDTkssS0FBS1UsU0FBV2YsRUFDaEJLLEtBQUs2QixjQUNQLENBRUFsQyxPQUFBQSxHQUNFLE9BQU9LLEtBQUtVLFFBQ2QsQ0FFQTBCLGdCQUFBQSxHQUNFcEMsS0FBS3NCLGFBQWFZLFNBQ2xCbEMsS0FBS3NCLGFBQWUsSUFDdEIsRUMvRmEsTUFBTWUsRUFDbkIvQyxXQUFBQSxDQUFZZ0QsRUFBVUMsR0FDcEJ2QyxLQUFLd0MsZUFBaUJGLEVBQVNHLGNBQy9CekMsS0FBSzBDLHNCQUF3QkosRUFBU0sscUJBQ3RDM0MsS0FBSzRDLHFCQUF1Qk4sRUFBU08sb0JBQ3JDN0MsS0FBSzhDLGlCQUFtQlIsRUFBU1MsZ0JBQ2pDL0MsS0FBS2dELFlBQWNWLEVBQVNXLFdBRTVCakQsS0FBS2tELE1BQVFYLENBQ2YsQ0FFQVksZUFBQUEsQ0FBZ0JDLEdBQ2QsTUFBTUMsRUFBaUJyRCxLQUFLa0QsTUFBTWhDLGNBQWUsSUFBR2tDLEVBQVFFLFlBQzVERixFQUFRcEIsVUFBVUMsSUFBSWpDLEtBQUs4QyxrQkFDM0JPLEVBQWUxQixZQUFjeUIsRUFBUUcsa0JBQ3JDRixFQUFlckIsVUFBVUMsSUFBSWpDLEtBQUtnRCxZQUNwQyxDQUVBUSxlQUFBQSxDQUFnQkosR0FDZCxNQUFNQyxFQUFpQnJELEtBQUtrRCxNQUFNaEMsY0FBZSxJQUFHa0MsRUFBUUUsWUFDNURGLEVBQVFwQixVQUFVRSxPQUFPbEMsS0FBSzhDLGtCQUM5Qk8sRUFBZTFCLFlBQWMsR0FDN0IwQixFQUFlckIsVUFBVUUsT0FBT2xDLEtBQUtnRCxZQUN2QyxDQUVBUyxnQkFBQUEsR0FDRSxPQUFRekQsS0FBSzBELFVBQVVDLE9BQU9QLEdBQVlBLEVBQVFRLFNBQVNDLE9BQzdELENBRUFDLGlCQUFBQSxHQUNFLEdBQUk5RCxLQUFLeUQsaUJBQWlCekQsS0FBSzBELFdBRzdCLE9BRkExRCxLQUFLK0QsY0FBYy9CLFVBQVVDLElBQUlqQyxLQUFLNEMsMkJBQ3RDNUMsS0FBSytELGNBQWNDLFVBQVcsR0FHaENoRSxLQUFLK0QsY0FBYy9CLFVBQVVFLE9BQU9sQyxLQUFLNEMsc0JBQ3pDNUMsS0FBSytELGNBQWNDLFVBQVcsQ0FDaEMsQ0FFQUMsbUJBQUFBLENBQW9CYixHQUNsQixPQUFLQSxFQUFRUSxTQUFTQyxNQUdmN0QsS0FBS3dELGdCQUFnQkosR0FGbkJwRCxLQUFLbUQsZ0JBQWdCQyxFQUdoQyxDQUVBeEIsa0JBQUFBLEdBQ0U1QixLQUFLMEQsVUFBWVEsTUFBTUMsS0FDckJuRSxLQUFLa0QsTUFBTWtCLGlCQUFpQnBFLEtBQUt3QyxpQkFFbkN4QyxLQUFLK0QsY0FBZ0IvRCxLQUFLa0QsTUFBTWhDLGNBQWNsQixLQUFLMEMsdUJBRW5EMUMsS0FBSzBELFVBQVVXLFNBQVNqQixJQUN0QkEsRUFBUXRCLGlCQUFpQixTQUFVd0MsSUFDakN0RSxLQUFLaUUsb0JBQW9CYixHQUN6QnBELEtBQUs4RCxtQkFBbUIsR0FDeEIsR0FFTixDQUVBUyxnQkFBQUEsR0FDRXZFLEtBQUtrRCxNQUFNcEIsaUJBQWlCLFVBQVd3QyxJQUNyQ0EsRUFBRUUsZ0JBQWdCLElBR3BCeEUsS0FBSzRCLG9CQUNQLEVDbEVLLE1BRU02QyxFQUFxQixDQUNoQ0MsYUFBYyxlQUNkakMsY0FBZSxnQkFDZkUscUJBQXNCLGlCQUN0QkUsb0JBQXFCLHlCQUNyQkUsZ0JBQWlCLDBCQUNqQkUsV0FBWSx3QkNOQyxNQUFNMEIsRUFDbkJyRixXQUFBQSxDQUFXQyxHQUFvQixJQUFuQixjQUFFcUYsR0FBZXJGLEVBQzNCUyxLQUFLNkUsY0FBZ0I1RCxTQUFTQyxjQUFjMEQsR0FDNUM1RSxLQUFLOEUsZ0JBQWtCOUUsS0FBSzhFLGdCQUFnQkMsS0FBSy9FLEtBQ25ELENBRUFnRixJQUFBQSxHQUNFaEYsS0FBSzZFLGNBQWM3QyxVQUFVQyxJQUFJLGdCQUNqQ2hCLFNBQVNhLGlCQUFpQixRQUFTOUIsS0FBSzhFLGdCQUMxQyxDQUVBRyxLQUFBQSxHQUNFakYsS0FBSzZFLGNBQWM3QyxVQUFVRSxPQUFPLGdCQUNwQ2pCLFNBQVNpRSxvQkFBb0IsUUFBU2xGLEtBQUs4RSxnQkFDN0MsQ0FFQUEsZUFBQUEsQ0FBZ0JLLEdEbEJTLEtDbUJuQkEsRUFBSUMsT0FDTnBGLEtBQUtpRixPQUVULENBRUFJLGlCQUFBQSxHQUNFckYsS0FBSzZFLGNBQWMvQyxpQkFBaUIsU0FBVXFELEtBRTFDQSxFQUFJRyxPQUFPdEQsVUFBVXVELFNBQVMsVUFDOUJKLEVBQUlHLE9BQU90RCxVQUFVdUQsU0FBUyxrQkFFOUJ2RixLQUFLaUYsT0FDUCxHQUVKLEVDL0JhLE1BQU1PLFVBQXNCYixFQUN6Q3JGLFdBQUFBLENBQVlzRixFQUFlYSxHQUN6QkMsTUFBTSxDQUFFZCxrQkFFUjVFLEtBQUsyRixXQUFhM0YsS0FBSzZFLGNBQWMzRCxjQUFjLGdCQUNuRGxCLEtBQUs0RixrQkFBb0JILEVBQ3pCekYsS0FBSzZFLGNBQWdCNUQsU0FBU0MsY0FBYzBELEdBQzVDNUUsS0FBSzZGLGFBQWU3RixLQUFLMkYsV0FBV3pFLGNBQWMsa0JBQ2xEbEIsS0FBSzhGLGlCQUFtQjlGLEtBQUs2RixhQUFhbEUsV0FDNUMsQ0FFQW9FLGVBQUFBLEdBUUUsT0FQQS9GLEtBQUtnRyxXQUFhaEcsS0FBSzZFLGNBQWNULGlCQUFpQixpQkFFdERwRSxLQUFLaUcsWUFBYyxDQUFDLEVBQ3BCakcsS0FBS2dHLFdBQVczQixTQUNiNkIsR0FBV2xHLEtBQUtpRyxZQUFZQyxFQUFNL0YsTUFBUStGLEVBQU1DLFFBRzVDbkcsS0FBS2lHLFdBQ2QsQ0FFQUcsYUFBQUEsQ0FBY0MsR0FBc0MsSUFBM0JDLEVBQVdDLFVBQUFDLE9BQUEsUUFBQUMsSUFBQUYsVUFBQSxHQUFBQSxVQUFBLEdBQUcsWUFFbkN2RyxLQUFLNkYsYUFBYWxFLFlBRGhCMEUsRUFDOEJDLEVBRUF0RyxLQUFLOEYsZ0JBRXpDLENBRUFULGlCQUFBQSxHQUNFckYsS0FBSzZFLGNBQWMvQyxpQkFBaUIsVUFBVSxLQUM1QzlCLEtBQUs0RixrQkFBa0I1RixLQUFLK0YsbUJBRTVCL0YsS0FBS2lGLE9BQU8sSUFFZFMsTUFBTUwsbUJBQ1IsQ0FFQUosS0FBQUEsR0FDRWpGLEtBQUsyRixXQUFXZSxRQUNoQmhCLE1BQU1ULE9BQ1IsRUMzQkYsTUFRTTBCLEVBQW9CMUYsU0FBU0MsY0FBYyx3QkFDM0MwRixFQUFtQjNGLFNBQVNDLGNBQWMsOEJBQzFDMkYsRUFBbUI1RixTQUFTQyxjQUFjLHVCQUMxQzRGLEVBQWtCN0YsU0FBU0MsY0FBYyxzQkFDekM2RixFQUFlOUYsU0FBU0MsY0FBYyxtQkFJdEM4RixHQUhhL0YsU0FBU0MsY0FBYyxnQkFDckJELFNBQVNDLGNBQWMsbUJBQ2pCRCxTQUFTQyxjQUFjLHlCQUN4QkQsU0FBU0MsY0FBYyx5QkFDM0MrRixFQUEwQmhHLFNBQVNDLGNBQ3ZDLDZCQUVJZ0csRUFBa0JMLEVBQWlCM0YsY0FBYyxnQkFJakRpRyxHQUhnQmxHLFNBQVNDLGNBQWMsbUJBRTNDRCxTQUFTQyxjQUFjLGtCQUFrQkMsUUFBUWlHLGtCQUMxQm5HLFNBQVNDLGNBQWMseUJBRzFDbUcsRUFBTSxJQzVDRyxNQUNiL0gsV0FBQUEsQ0FBV0MsR0FBdUIsSUFBdEIsUUFBRStILEVBQU8sUUFBRUMsR0FBU2hJLEVBQzlCUyxLQUFLd0gsU0FBV0YsRUFDaEJ0SCxLQUFLeUgsZUFBaUJGLEVBQVFHLGFBQ2hDLENBRUFDLFVBQUFBLEdBQ0UsT0FBT0MsUUFBUUMsSUFBSSxDQUFDN0gsS0FBSzhILGtCQUFtQjlILEtBQUsrSCxlQUNuRCxDQUVBQyxpQkFBQUEsQ0FBaUJDLEdBQXlCLElBQXhCLE1BQUVDLEVBQUssWUFBRUMsR0FBYUYsRUFDdEMsT0FBT0csTUFBTyxHQUFFcEksS0FBS3dILG9CQUFxQixDQUN4Q2EsT0FBUSxRQUNSZCxRQUFTLENBQ1BHLGNBQWUxSCxLQUFLeUgsZUFDcEIsZUFBZ0Isb0JBRWxCYSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CckksS0FBTStILEVBQ05PLE1BQU9OLE1BR1JPLE1BQU1DLEdBQ0VBLEVBQUlDLEdBQUtELEVBQUlFLE9BQVNqQixRQUFRa0IsT0FBUSxVQUFTSCxFQUFJSSxZQUUzREMsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxHQUV4QixDQUVBRyxZQUFBQSxDQUFZQyxHQUFhLElBQVosT0FBRUMsR0FBUUQsRUFDckIsT0FBT2pCLE1BQU8sR0FBRXBJLEtBQUt3SCwyQkFBNEIsQ0FDL0NhLE9BQVEsUUFDUmQsUUFBUyxDQUNQRyxjQUFlMUgsS0FBS3lILGVBQ3BCLGVBQWdCLG9CQUVsQmEsS0FBTUMsS0FBS0MsVUFBVSxDQUNuQmMsYUFHRFosTUFBTUMsR0FDTEEsRUFBSUMsR0FBS0QsRUFBSUUsT0FBU2pCLFFBQVFrQixPQUFRLFVBQVNILEVBQUlJLFlBRXBEQyxPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLEdBRXhCLENBRUFNLE9BQUFBLENBQU9DLEdBQWlCLElBQWhCLEtBQUVySixFQUFJLEtBQUVFLEdBQU1tSixFQUNwQixPQUFPcEIsTUFBTyxHQUFFcEksS0FBS3dILGlCQUFrQixDQUNyQ2EsT0FBUSxPQUNSZCxRQUFTLENBQ1BHLGNBQWUxSCxLQUFLeUgsZUFDcEIsZUFBZ0Isb0JBRWxCYSxLQUFNQyxLQUFLQyxVQUFVLENBQ25CckksT0FDQUUsV0FHRHFJLE1BQU1DLEdBQ0xBLEVBQUlDLEdBQUtELEVBQUlFLE9BQVNqQixRQUFRa0IsT0FBUSxVQUFTSCxFQUFJSSxZQUVwREMsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxHQUV4QixDQUVBUSxVQUFBQSxDQUFXQyxHQUNULE9BQU90QixNQUFPLEdBQUVwSSxLQUFLd0gsa0JBQWtCa0MsSUFBVSxDQUMvQ3JCLE9BQVEsU0FDUmQsUUFBUyxDQUNQRyxjQUFlMUgsS0FBS3lILGVBQ3BCLGVBQWdCLHNCQUdqQmlCLE1BQU1DLEdBQ0xBLEVBQUlDLEdBQUtELEVBQUlFLE9BQVNqQixRQUFRa0IsT0FBUSxVQUFTSCxFQUFJSSxZQUVwREMsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxHQUV4QixDQUVBVSxXQUFBQSxDQUFZRCxHQUNWLE9BQU90QixNQUFPLEdBQUVwSSxLQUFLd0gsa0JBQWtCa0MsVUFBZ0IsQ0FDckRyQixPQUFRLE1BQ1JkLFFBQVMsQ0FDUEcsY0FBZTFILEtBQUt5SCxlQUNwQixlQUFnQixzQkFHakJpQixNQUFNQyxHQUNMQSxFQUFJQyxHQUFLRCxFQUFJRSxPQUFTakIsUUFBUWtCLE9BQVEsVUFBU0gsRUFBSUksWUFFcERDLE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksR0FFeEIsQ0FFQVcsY0FBQUEsQ0FBZUYsR0FDYixPQUFPdEIsTUFBTyxHQUFFcEksS0FBS3dILGtCQUFrQmtDLFVBQWdCLENBQ3JEckIsT0FBUSxTQUNSZCxRQUFTLENBQ1BHLGNBQWUxSCxLQUFLeUgsZUFDcEIsZUFBZ0Isc0JBR2pCaUIsTUFBTUMsR0FDTEEsRUFBSUMsR0FBS0QsRUFBSUUsT0FBU2pCLFFBQVFrQixPQUFRLFVBQVNILEVBQUlJLFlBRXBEQyxPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLEdBRXhCLENBRUFuQixlQUFBQSxHQUNFLE9BQU9NLE1BQU8sR0FBRXBJLEtBQUt3SCxpQkFBa0IsQ0FDckNELFFBQVMsQ0FDUEcsY0FBZTFILEtBQUt5SCxrQkFHckJpQixNQUFNQyxHQUNMQSxFQUFJQyxHQUFLRCxFQUFJRSxPQUFTakIsUUFBUWtCLE9BQVEsVUFBU0gsRUFBSUksWUFFcERDLE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksR0FFeEIsQ0FFQWxCLFdBQUFBLEdBQ0UsT0FBT0ssTUFBTyxHQUFFcEksS0FBS3dILG9CQUFxQixDQUN4Q0QsUUFBUyxDQUNQRyxjQUFlMUgsS0FBS3lILGtCQUdyQmlCLE1BQU1DLEdBQ0xBLEVBQUlDLEdBQUtELEVBQUlFLE9BQVNqQixRQUFRa0IsT0FBUSxVQUFTSCxFQUFJSSxZQUVwREMsT0FBT0MsSUFDTkMsUUFBUUMsTUFBTUYsRUFBSSxHQUV4QixHRG5Ha0IsQ0FDbEIzQixRQUFTLGtEQUNUQyxRQUFTLENBQ1BHLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBSWRtQyxFQUFrQixJQUFJckUsRUFBYyxzQkFBdUJzRSxJQUMvREQsRUFBZ0J6RCxlQUFjLEVBQU0sYUFFcENpQixFQUNHK0IsYUFBYVUsR0FDYnBCLE1BQU1DLElBQ0xvQixFQUFTQyxVQUFVckIsRUFBSVcsUUFFdkJPLEVBQWdCNUUsT0FBTyxJQUV4QitELE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksSUFFbkJnQixTQUFRLEtBQ1BKLEVBQWdCekQsZUFBYyxFQUFNLEdBQ3BDLElBR0E4RCxFQUFXLENBQUV0RixjSHhESCxnQkd5RFZ1RixFQUFtQixJRXJFVixjQUE2QnhGLEVBQzFDckYsV0FBQUEsQ0FBWXNGLEdBQ1ZjLE1BQU1kLEdBQ041RSxLQUFLb0ssY0FBZ0JwSyxLQUFLNkUsY0FBYzNELGNBQWMsaUJBQ3REbEIsS0FBS3FLLGNBQWdCckssS0FBSzZFLGNBQWMzRCxjQUFjLGtCQUN4RCxDQUVBOEQsSUFBQUEsQ0FBS3ZGLEdBQ0hPLEtBQUtvSyxjQUFjN0ksSUFBTTlCLEVBQUtZLEtBQzlCTCxLQUFLb0ssY0FBYzVJLElBQU0vQixFQUFLVSxLQUM5QkgsS0FBS3FLLGNBQWMxSSxZQUFjbEMsRUFBS3NDLEtBQ3RDMkQsTUFBTVYsTUFDUixHRnlEMENrRixHQUN0Q0gsRUFBVyxJR3hFRixNQUNiekssV0FBQUEsQ0FBWWdMLEVBQWNDLEVBQWFDLEdBQ3JDeEssS0FBS0UsTUFBUWUsU0FBU0MsY0FBY29KLEdBQ3BDdEssS0FBS3lLLEtBQU94SixTQUFTQyxjQUFjcUosR0FDbkN2SyxLQUFLMEssUUFBVXpKLFNBQVNDLGNBQWNzSixFQUN4QyxDQUVBekMsV0FBQUEsR0FLRSxPQUpBL0gsS0FBSzJLLFVBQVksQ0FDZnhLLEtBQU1ILEtBQUtFLE1BQU15QixZQUNqQndHLFlBQWFuSSxLQUFLeUssS0FBSzlJLGFBRWxCM0IsS0FBSzJLLFNBQ2QsQ0FFQUMsV0FBQUEsQ0FBWUMsRUFBV0MsR0FDckI5SyxLQUFLRSxNQUFNeUIsWUFBY2tKLEVBQ3pCN0ssS0FBS3lLLEtBQUs5SSxZQUFjbUosQ0FDMUIsQ0FFQWQsU0FBQUEsQ0FBVVYsR0FDUnRKLEtBQUswSyxRQUFRbkosSUFBTStILENBQ3JCLEdIbURBLGtCQUNBLHdCQUNBLG1CQUdGakMsRUFBSVUsY0FBY1csTUFBTXFDLElBQ3RCN0IsUUFBUThCLElBQUlELEdBQ1poQixFQUFTYSxZQUFZRyxFQUFTNUssS0FBTTRLLEVBQVN0QyxNQUFNLElBR3JELE1BQU13QyxFQUFxQixJSWpGWixjQUFvQ3RHLEVBQ2pEckYsV0FBQUEsQ0FBWXNGLEVBQWVhLEdBQ3pCQyxNQUFNLENBQUVkLGtCQUVSNUUsS0FBSzJGLFdBQWEzRixLQUFLNkUsY0FBYzNELGNBQWMsZ0JBQ25EbEIsS0FBSzRGLGtCQUFvQkgsQ0FDM0IsQ0FFQUosaUJBQUFBLEdBQ0VyRixLQUFLMkYsV0FBVzdELGlCQUFpQixVQUFXcUQsSUFDMUNBLEVBQUlYLGlCQUNKeEUsS0FBSzRGLG9CQUNMNUYsS0FBS2lGLE9BQU8sSUFFZFMsTUFBTUwsbUJBQ1IsQ0FFQUosS0FBQUEsR0FDRVMsTUFBTVQsT0FDUixDQUVBaUcsZUFBQUEsQ0FBZ0JDLEdBQ2RuTCxLQUFLNEYsa0JBQW9CdUYsQ0FDM0IsR0oyREEseUJBQ0M3SCxJQUNDMkgsRUFBbUI3RSxlQUFjLEVBQU0sZUFFdkNpQixFQUNHb0MsV0FBV25HLEdBQ1hvRixNQUFLLEtBQ0p1QyxFQUFtQmhHLE9BQU8sSUFFM0IrRCxPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLElBRW5CZ0IsU0FBUSxLQUNQZ0IsRUFBbUI3RSxlQUFjLEVBQU0sR0FDdkMsSUFHUjZFLEVBQW1CNUYsb0JBRW5CLE1BQU0rRixFQUFjQyxHQUNILElBQUloTSxFQUNqQixDQUNFSSxLQUFNNEwsRUFFTnpMLGlCQUFtQjBMLElBQ2pCbkIsRUFBaUJuRixLQUFLc0csRUFBUSxFQUVoQ3pMLHdCQUNBQyx1QkhuR1Usa0JHd0dBdUIsVUFHVmtLLEVBQWMsSUt4SEwsTUFDYmpNLFdBQUFBLENBQVdDLEVBQWVpTSxHQUFtQixJQUFqQyxTQUFFQyxHQUFVbE0sRUFDdEJTLEtBQUswTCxVQUFZRCxFQUNqQnpMLEtBQUsyTCxXQUFhMUssU0FBU0MsY0FBY3NLLEVBQzNDLENBRUFJLFdBQUFBLENBQVlDLEdBQ1ZBLEVBQU14SCxRQUFRckUsS0FBSzBMLFVBQ3JCLENBRUFJLE9BQUFBLENBQVFDLEdBQ04vTCxLQUFLMkwsV0FBV0ssUUFBUUQsRUFDMUIsR0w2R0EsQ0FDRU4sU0FBV1EsSUFDVCxNQUFNQyxFQUFTZCxFQUFXYSxHQUMxQlYsRUFBWU8sUUFBUUksRUFBTyxHSGhIbEIsZ0JHc0hUQyxFQUFZLElBQUkzRyxFQUFjLHVCQUF3QjRHLEtBZ0U1RCxTQUFpQ0EsR0FDL0JELEVBQVUvRixlQUFjLEVBQU0sYUFDOUJpQixFQUNHVyxrQkFBa0JvRSxHQUNsQjFELE1BQU1DLElBQ0wsTUFBTSxLQUFFeEksRUFBSSxNQUFFc0ksR0FBVUUsRUFDeEJvQixFQUFTYSxZQUFZekssRUFBTXNJLEdBQzNCMEQsRUFBVWxILE9BQU8sSUFHbEJnRixTQUFRLEtBQ1BrQyxFQUFVL0YsZUFBYyxFQUFNLEdBRXBDLENBNUVFaUcsQ0FBd0JELEVBQUksSUFHeEJFLEVBQVcsSUFBSTlHLEVBQWMsbUJBQW9CNEcsS0EyRXZELFNBQThCQSxHQUM1QkUsRUFBU2xHLGVBQWMsRUFBTSxhQUM3QmlCLEVBQ0drQyxRQUFRNkMsR0FDUjFELE1BQU1vQixJQUNMLE1BQU1vQyxFQUFTZCxFQUFXdEIsR0FDMUJ5QixFQUFZTyxRQUFRSSxFQUFPLElBRTVCakMsU0FBUSxLQUNQcUMsRUFBU2xHLGVBQWMsRUFBTSxHQUVuQyxDQXJGRW1HLENBQXFCSCxFQUFJLElBR3JCSSxFQUFvQixJQUFJbkssRUFDNUJvQyxFQUNBeUMsR0FFSXVGLEVBQW1CLElBQUlwSyxFQUFjb0MsRUFBb0JzQyxHQUV6RDJGLEVBQXNCLElBQUlySyxFQUM5Qm9DLEVBQ0FxQyxHQW9CRixTQUFTakgsSUFDUG9MLEVBQW1CakcsT0FDbkJpRyxFQUFtQkMsaUJBQWdCLEtBQ2pDLE1BQU01SCxFQUFLdEQsS0FBS2UsUUFFaEJzRyxFQUNHb0MsV0FBV25HLEdBQ1hvRixNQUFNQyxJQUNMM0ksS0FBS29DLGtCQUFrQixJQUV4QjRHLE9BQU9DLElBQ05DLFFBQVFDLE1BQU1GLEVBQUksR0FDbEIsR0FFUixDQUVBLFNBQVNuSixFQUFvQjZNLEVBQVFoTixHQUMvQkEsRUFDRjBILEVBQ0d1QyxlQUFlK0MsR0FDZmpFLE1BQU1vQixHQUFhOUosS0FBS21DLFFBQVEySCxFQUFTbkssV0FFNUMwSCxFQUFJc0MsWUFBWWdELEdBQVFqRSxNQUFNb0IsSUFDNUI5SixLQUFLbUMsUUFBUTJILEVBQVNuSyxRQUFRLEdBR3BDLENBMUNBMEgsRUFBSVMsa0JBQWtCWSxNQUFNa0UsSUFDMUJyQixFQUFZSyxZQUFZZ0IsRUFBTSxJQUdoQ3pDLEVBQWlCOUUsb0JBQ2pCOEcsRUFBVTlHLG9CQUNWaUgsRUFBU2pILG9CQUNUd0UsRUFBZ0J4RSxvQkFDaEJtSCxFQUFrQmpJLG1CQUNsQmtJLEVBQWlCbEksbUJBQ2pCbUksRUFBb0JuSSxtQkE0RXBCb0MsRUFBa0I3RSxpQkFBaUIsU0FSbkMsWUFOQSxXQUNFLE1BQU0sS0FBRTNCLEVBQUksWUFBRWdJLEdBQWdCNEIsRUFBU2hDLGNBQ3ZDZixFQUFrQmIsTUFBUWhHLEVBQzFCOEcsRUFBd0JkLE1BQVFnQyxDQUNsQyxDQUdFMEUsR0FDQVYsRUFBVW5ILE1BQ1osSUFPQW1DLEVBQWlCckYsaUJBQWlCLFNBQVMsS0FDekMySyxFQUFpQjNJLG9CQUNqQndJLEVBQVN0SCxNQUFNLElBR2pCNEIsRUFBaUI5RSxpQkFBaUIsU0FBUyxLQUN6QzRLLEVBQW9CNUksb0JBQ3BCK0YsRUFBZ0I3RSxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaSBmcm9tIFwiLi9BcGlcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHtcbiAgICAgIGRhdGEsXG4gICAgICB1c2VySUQsXG4gICAgICBpc0xpa2VkLFxuICAgICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICAgIGhhbmRsZURlbGV0ZUNhcmRDbGljayxcbiAgICAgIGhhbmRsZUNhcmRMaWtlQ2xpY2ssXG4gICAgICBoYW5kbGVDb25maXJtLFxuICAgIH0sXG4gICAgY2FyZFNlbGVjdG9yXG4gICkge1xuICAgIHRoaXMuX2hhbmRsZUNvbmZpcm0gPSBoYW5kbGVDb25maXJtO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9vd25lciA9IGRhdGEub3duZXI7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl91c2VySUQgPSB1c2VySUQ7XG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZENsaWNrID0gaGFuZGxlRGVsZXRlQ2FyZENsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlQ2xpY2sgPSBoYW5kbGVDYXJkTGlrZUNsaWNrO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIikuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY2FyZF9faW1hZ2VcIlxuICAgICkuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fbmFtZX1gO1xuXG4gICAgdGhpcy5fY2FyZENhcHRpb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2NhcmRDYXB0aW9uLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vXCIuY2FyZF9fbGlrZS1idXR0b25cIlxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlQ2xpY2sodGhpcy5faWQsIHRoaXMuX2lzTGlrZWQpO1xuICAgIH0pO1xuXG4gICAgLy9cIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDYXJkQ2xpY2soKSk7XG5cbiAgICAvL1wiI2ltYWdlLXBvcHVwXCJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IGxpbms6IHRoaXMuX2xpbmssIHRleHQ6IHRoaXMuX25hbWUgfSlcbiAgICAgICk7XG4gIH1cblxuICBfcmVuZGVyTGlrZXMoKSB7XG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIHNldExpa2UoaXNMaWtlZCkge1xuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xuICB9XG5cbiAgaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgfVxuXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxzLmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbHMpKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKSB7XG4gICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVscyA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG5cbiAgICB0aGlzLl9pbnB1dEVscy5mb3JFYWNoKChpbnB1dEVsKSA9PiB7XG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBFU0NfS0VZQ09ERSA9IDI3O1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XG4gIGNhcmRTZWN0aW9uOiBcIi5jYXJkc19fbGlzdFwiLFxuICBjYXJkVGVtcGxhdGU6IFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgcHJldmlld1BvcHVwOiBcIiNpbWFnZS1wb3B1cFwiLFxufTtcbiIsImltcG9ydCB7IEVTQ19LRVlDT0RFIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQud2hpY2ggPT09IEVTQ19LRVlDT0RFKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLnN1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKFxuICAgICAgKGlucHV0KSA9PiAodGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlKVxuICAgICk7XG5cbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcbiAgfVxuXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLnN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuc3VibWl0QnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuXG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gIH1cbn1cbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IHtcbiAgaGFuZGxlRXNjYXBlLFxuICBjbG9zZVBvcHVwLFxuICBvcGVuUG9wdXAsXG4gIGhhbmRsZVBvcHVwQ2xvc2UsXG59IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiO1xuaW1wb3J0IHsgdmFsaWRhdGlvblNldHRpbmdzLCBzZWxlY3RvcnMgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5cbmNvbnN0IGNhcmREYXRhID0ge1xuICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG59O1xuXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbi8qICAgICAgICAgICAgICAgICAgICAgIEVsZW1lbnRzICAgICAgICAgICAgICAgICAgICAqL1xuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IGF2YXRhckVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1jb250YWluZXJcIik7XG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5jb25zdCBhdmF0YXJFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1lZGl0LW1vZGFsXCIpO1xuY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGltYWdlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2ltYWdlLXBvcHVwXCIpO1xuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZWNyaXB0aW9uLWlucHV0XCJcbik7XG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9XG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xuY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcblxuLy8gSW5zdGFuY2VzIG9mIHRoZSBDbGFzc2VzXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCIyN2QxYmQ3MC0xMDhkLTRmOGItYjM1YS0yZmI0ZmI4OTk4YTdcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhdmF0YXItZWRpdC1tb2RhbFwiLCAoY2FyZERhdGEpID0+IHtcbiAgZWRpdEF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJTYXZpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLnVwZGF0ZUF2YXRhcihjYXJkRGF0YSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRBdmF0YXIocmVzLmF2YXRhcik7XG5cbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn0pO1xuXG5jb25zdCBzZWxlY3RvciA9IHsgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLnByZXZpZXdQb3B1cCB9O1xuY29uc3QgY2FyZFByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3Rvcik7XG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcbiAgXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgXCIucHJvZmlsZV9faW1hZ2VcIlxuKTtcblxuYXBpLmdldFVzZXJJbmZvKCkudGhlbigodXNlckRhdGEpID0+IHtcbiAgY29uc29sZS5sb2codXNlckRhdGEpO1xuICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCk7XG59KTtcblxuY29uc3QgY29uZmlybURlbGV0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcbiAgXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIixcbiAgKGlkKSA9PiB7XG4gICAgY29uZmlybURlbGV0ZU1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJEZWxldGluZy4uLlwiKTtcblxuICAgIGFwaVxuICAgICAgLnJlbW92ZUNhcmQoaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNvbmZpcm1EZWxldGVNb2RhbC5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgIGNvbmZpcm1EZWxldGVNb2RhbC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICB9XG4pO1xuY29uZmlybURlbGV0ZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoY2FyZCkgPT4ge1xuICBjb25zdCBjYXJkRWwgPSBuZXcgQ2FyZChcbiAgICB7XG4gICAgICBkYXRhOiBjYXJkLFxuICAgICAgLy90aGlzLl91c2VySUQsLy9cbiAgICAgIGhhbmRsZUltYWdlQ2xpY2s6IChpbWdEYXRhKSA9PiB7XG4gICAgICAgIGNhcmRQcmV2aWV3UG9wdXAub3BlbihpbWdEYXRhKTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVEZWxldGVDYXJkQ2xpY2ssXG4gICAgICBoYW5kbGVDYXJkTGlrZUNsaWNrLFxuICAgIH0sXG4gICAgc2VsZWN0b3JzLmNhcmRUZW1wbGF0ZVxuICApO1xuXG4gIHJldHVybiBjYXJkRWwuZ2V0VmlldygpO1xufTtcblxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsID0gcmVuZGVyQ2FyZChpdGVtKTtcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsKTtcbiAgICB9LFxuICB9LFxuICBzZWxlY3RvcnMuY2FyZFNlY3Rpb25cbik7XG5cbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLCAob2JqKSA9PiB7XG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KG9iaik7XG59KTtcblxuY29uc3QgYWRkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNhZGQtY2FyZC1tb2RhbFwiLCAob2JqKSA9PiB7XG4gIGhhbmRsZVBob3RvQWRkU3VibWl0KG9iaik7XG59KTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBwcm9maWxlRWRpdEZvcm1cbik7XG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBhZGRDYXJkTW9kYWwpO1xuXG5jb25zdCBlZGl0QXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcbiAgYXZhdGFyRWRpdE1vZGFsXG4pO1xuXG4vL0luaXRpYWxpemUgYWxsIGluc3RhbmNlc1xuYXBpLmdldEluaXRpYWxDYXJkcygpLnRoZW4oKGNhcmRzKSA9PiB7XG4gIGNhcmRTZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcbn0pO1xuXG5jYXJkUHJldmlld1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmFkZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuZWRpdEF2YXRhclZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuLyogICAgICAgICAgICAgICAgICAgICAgRnVuY3Rpb25zICAgICAgICAgICAgICAgICAgICovXG4vKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZENsaWNrKCkge1xuICBjb25maXJtRGVsZXRlTW9kYWwub3BlbigpO1xuICBjb25maXJtRGVsZXRlTW9kYWwuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcbiAgICBjb25zdCBpZCA9IHRoaXMuZ2V0SWQoKTtcblxuICAgIGFwaVxuICAgICAgLnJlbW92ZUNhcmQoaWQpXG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIHRoaXMuaGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZExpa2VDbGljayhjYXJkSWQsIGlzTGlrZWQpIHtcbiAgaWYgKGlzTGlrZWQpIHtcbiAgICBhcGlcbiAgICAgIC5yZW1vdmVDYXJkTGlrZShjYXJkSWQpXG4gICAgICAudGhlbigoY2FyZERhdGEpID0+IHRoaXMuc2V0TGlrZShjYXJkRGF0YS5pc0xpa2VkKSk7XG4gIH0gZWxzZSB7XG4gICAgYXBpLmFkZENhcmRMaWtlKGNhcmRJZCkudGhlbigoY2FyZERhdGEpID0+IHtcbiAgICAgIHRoaXMuc2V0TGlrZShjYXJkRGF0YS5pc0xpa2VkKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChvYmopIHtcbiAgZWRpdFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSwgXCJTYXZpbmcuLi5cIik7XG4gIGFwaVxuICAgIC51cGRhdGVQcm9maWxlSW5mbyhvYmopXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgY29uc3QgeyBuYW1lLCBhYm91dCB9ID0gcmVzO1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8obmFtZSwgYWJvdXQpO1xuICAgICAgZWRpdFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAvLyBjb25zb2xlLmxvZyhvYmopXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgZWRpdFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQaG90b0FkZFN1Ym1pdChvYmopIHtcbiAgYWRkUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlLCBcIlNhdmluZy4uLlwiKTtcbiAgYXBpXG4gICAgLmFkZENhcmQob2JqKVxuICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsID0gcmVuZGVyQ2FyZChjYXJkRGF0YSk7XG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbCk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBhZGRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZmlsbFByb2ZpbGVGb3JtKCkge1xuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IG5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gZGVzY3JpcHRpb247XG59XG5cbmZ1bmN0aW9uIG9wZW5FZGl0UHJvZmlsZU1vZGFsKCkge1xuICBmaWxsUHJvZmlsZUZvcm0oKTtcbiAgZWRpdFBvcHVwLm9wZW4oKTtcbn1cblxuLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG4vKiAgICAgICAgICAgICAgICAgRXZlbnQgSGFuZGxlcnMgICAgICAgICAgICAgICAgICAgKi9cbi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5FZGl0UHJvZmlsZU1vZGFsKTtcblxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBhZGRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIGFkZFBvcHVwLm9wZW4oKTtcbn0pO1xuXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRBdmF0YXJWYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcbn0pO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9hdXRob3JpemF0aW9uID0gaGVhZGVycy5hdXRob3JpemF0aW9uO1xuICB9XG5cbiAgZ2V0QXBwSW5mbygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xuICB9XG5cbiAgdXBkYXRlUHJvZmlsZUluZm8oeyB0aXRsZSwgZGVzY3JpcHRpb24gfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IHRpdGxlLCAvLyBBUEkgZXhwZWN0cyB0aXRsZSBvciBuYW1lP1xuICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXG4gICAgICB9KSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICByZXR1cm4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlQXZhdGFyKHsgYXZhdGFyIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+XG4gICAgICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKVxuICAgICAgKVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fYXV0aG9yaXphdGlvbixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBsaW5rLFxuICAgICAgfSksXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+XG4gICAgICAgIHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKVxuICAgICAgKVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH1cblxuICByZW1vdmVDYXJkKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT5cbiAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApXG4gICAgICApXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIGFkZENhcmRMaWtlKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT5cbiAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApXG4gICAgICApXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHJlbW92ZUNhcmRMaWtlKGNhcmRJRCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT5cbiAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApXG4gICAgICApXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX2F1dGhvcml6YXRpb24sXG4gICAgICB9LFxuICAgIH0pXG4gICAgICAudGhlbigocmVzKSA9PlxuICAgICAgICByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YClcbiAgICAgIClcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl9hdXRob3JpemF0aW9uLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT5cbiAgICAgICAgcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApXG4gICAgICApXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fbW9kYWxJbWFnZUVsID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuICAgIHRoaXMuX21vZGFsQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuICB9XG5cbiAgb3BlbihkYXRhKSB7XG4gICAgdGhpcy5fbW9kYWxJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcbiAgICB0aGlzLl9tb2RhbEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX21vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEudGV4dDtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZVNlbGVjdG9yLCBqb2JTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgdGhpcy5fdXNlckluZm8gPSB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2pvYi50ZXh0Q29udGVudCxcbiAgICB9O1xuICAgIHJldHVybiB0aGlzLl91c2VySW5mbztcbiAgfVxuXG4gIHNldFVzZXJJbmZvKG5hbWVJbnB1dCwgam9iSW5wdXQpIHtcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZUlucHV0O1xuICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGpvYklucHV0O1xuICB9XG5cbiAgc2V0QXZhdGFyKGF2YXRhcikge1xuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG5cbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG5cbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBhY3Rpb247XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJkYXRhIiwidXNlcklEIiwiaXNMaWtlZCIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkQ2xpY2siLCJoYW5kbGVDYXJkTGlrZUNsaWNrIiwiaGFuZGxlQ29uZmlybSIsInRoaXMiLCJfaGFuZGxlQ29uZmlybSIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9vd25lciIsIm93bmVyIiwiX2lkIiwiX3VzZXJJRCIsIl9pc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNhcmRDbGljayIsIl9oYW5kbGVDYXJkTGlrZUNsaWNrIiwiZ2V0SWQiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsIl9jYXJkRWxlbWVudCIsInNyYyIsImFsdCIsIl9jYXJkQ2FwdGlvbiIsIl9saWtlQnV0dG9uIiwidGV4dENvbnRlbnQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfcmVuZGVyTGlrZXMiLCJhZGRFdmVudExpc3RlbmVyIiwidGV4dCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsInNldExpa2UiLCJoYW5kbGVEZWxldGVDYXJkIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWwiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxzIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NDbG9zZSIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwid2hpY2giLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsInN1Ym1pdEJ1dHRvbiIsInN1Ym1pdEJ1dHRvblRleHQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfaW5wdXRMaXN0IiwiX2Zvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicmVzZXQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsImF2YXRhckVkaXRCdXR0b24iLCJwcm9maWxlRWRpdE1vZGFsIiwiYXZhdGFyRWRpdE1vZGFsIiwiYWRkQ2FyZE1vZGFsIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsInByb2ZpbGVFZGl0Rm9ybSIsImFkZE5ld0NhcmRCdXR0b24iLCJmaXJzdEVsZW1lbnRDaGlsZCIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfYXV0aG9yaXphdGlvbiIsImF1dGhvcml6YXRpb24iLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwidXBkYXRlUHJvZmlsZUluZm8iLCJfcmVmMiIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJmZXRjaCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJ1cGRhdGVBdmF0YXIiLCJfcmVmMyIsImF2YXRhciIsImFkZENhcmQiLCJfcmVmNCIsInJlbW92ZUNhcmQiLCJjYXJkSUQiLCJhZGRDYXJkTGlrZSIsInJlbW92ZUNhcmRMaWtlIiwiZWRpdEF2YXRhclBvcHVwIiwiY2FyZERhdGEiLCJ1c2VySW5mbyIsInNldEF2YXRhciIsImZpbmFsbHkiLCJzZWxlY3RvciIsImNhcmRQcmV2aWV3UG9wdXAiLCJfbW9kYWxJbWFnZUVsIiwiX21vZGFsQ2FwdGlvbiIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfam9iIiwiX2F2YXRhciIsIl91c2VySW5mbyIsInNldFVzZXJJbmZvIiwibmFtZUlucHV0Iiwiam9iSW5wdXQiLCJ1c2VyRGF0YSIsImxvZyIsImNvbmZpcm1EZWxldGVNb2RhbCIsInNldFN1Ym1pdEFjdGlvbiIsImFjdGlvbiIsInJlbmRlckNhcmQiLCJjYXJkIiwiaW1nRGF0YSIsImNhcmRTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiaXRlbSIsImNhcmRFbCIsImVkaXRQb3B1cCIsIm9iaiIsImhhbmRsZVByb2ZpbGVFZGl0U3VibWl0IiwiYWRkUG9wdXAiLCJoYW5kbGVQaG90b0FkZFN1Ym1pdCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsImVkaXRBdmF0YXJWYWxpZGF0b3IiLCJjYXJkSWQiLCJjYXJkcyIsImZpbGxQcm9maWxlRm9ybSJdLCJzb3VyY2VSb290IjoiIn0=